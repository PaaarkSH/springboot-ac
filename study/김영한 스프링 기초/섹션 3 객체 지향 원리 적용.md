# μ„Ήμ… 3 κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

# μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

## μƒλ΅μ΄ ν• μΈ μ •μ±… ν™•μ¥

- μ•…λ• κΈ°νμ: μ„λΉ„μ¤ μ¤ν” μ§μ „μ— ν• μΈ μ •μ±…μ„ μ§€κΈμ²λΌ κ³ μ • κΈμ•΅ ν• μΈμ΄ μ•„λ‹λΌ μΆ€ λ” ν•©λ¦¬μ μΈ μ£Όλ¬Έ κΈμ•΅λ‹Ή ν• μΈν•λ” μ •λ¥  ν• μΈμΌλ΅ λ³€κ²½ν•κ³  μ‹¶μ
    - μλ¥Ό λ“¤μ–΄ κΈ°μ΅΄ μ •μ±…μ€ VIP κ°€ 10000μ›μ„ μ£Όλ¬Έν•λ“  20000μ›μ„ μ£Όλ¬Έν•λ“  ν•­ μƒ 1000μ›μ„ ν• μΈν•λ”λ°, μ΄λ²μ— μƒλ΅ λ‚μ¨ μ •μ±…μ€ 10% λ΅ μ§€μ •ν•΄λ‘λ©΄ κ³ κ°μ΄ 10000μ›μ„ ν• μΈν•΄μ£Όκ³ , 20000μ› μ£Όλ¬Έμ‹μ— 2000μ› ν• μΈμ„ ν•΄μ£Όλ” λ°©μ‹
- μμ§„ κ°λ°μ: μ²μλ¶€ν„° κ³ μ • κΈμ•΅μ€ μ•„λ‹μ€μ
- μ•…λ•κΈ°νμ: μ—μμΌ μ†ν”„νΈ μ›¨μ–΄ κ°λ°μ— λ³΄λ©΄ β†’ κ³„νμ„ λ”°λ¥΄κΈ° λ³΄λ‹¤ λ³€ν™”μ— λ€μ‘
- μμ§„ κ°λ°μ: μ΄λ―Έ κ°μ²΄μ§€ν–¥ μ›μΉ™μ„ μ§€μΌ°κΈ° λ•λ¬Έμ— κ°€λ¥

<aside>
π’΅ κ°μ²΄ μ§€ν–¥ μ›μΉ™μ„ μ μ¤€μν–λ”μ§€ ν™•μΈν•΄λ³΄μ. μ΄λ²μ—λ” μ£Όλ¬Έ κΈμ•΅μ % ν• μΈμ„ ν•΄μ£Όλ” μƒλ΅μ΄ μ •λ¥  ν• μΈ μ •μ±…μ„ μ¶”κ°€ν•΄λ³΄μ

</aside>

## RateDiscountPolicy μ¶”κ°€

- OrderServiceImple β†’ DiscountPolicy(interface)

# μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

## λ°©κΈ μ¶”κ°€ν• ν• μΈ μ •μ±…μ„ μ μ©ν•΄λ³΄μ

## ν• μΈ μ •μ±…μ„ μ–΄ν”λ¦¬μΌ€μ΄μ…μ— μ μ©ν•΄λ³΄μ

- κΈ°μ΅΄μ— μ‚¬μ©ν–λ μ½”λ“μ—μ„ μƒλ΅μ΄ μ •μ±… κµ¬ν„μ²΄λ΅ λ³€κ²½ν•΄μ¤¬μ

```java
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
```

- **ν• μΈ μ •μ±…μ„ λ³€κ²½ν•λ ¤λ©΄ ν΄λΌμ΄μ–ΈνΈμΈ OrderServiceImpl μ½”λ“λ¥Ό κ³ μ³μ•Ό ν•λ‹¤**

## λ¬Έμ μ  λ°κ²¬

- μ°λ¦¬λ” μ—­ν™κ³Ό κµ¬ν„μ„ μ¶©μ‹¤ν•κ² λ¶„λ¦¬ν–λ‹¤ β†’ OK
- λ‹¤ν•μ„±λ„ ν™μ©ν•κ³ , μΈν„°νμ΄μ¤μ™€ κµ¬ν„ κ°μ²΄λ¥Ό λ¶„λ¦¬ν–λ‹¤ β†’ OK
- OCP DIP κ°™μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ¤€μν–λ‹¤
    - **κ·Έλ ‡κ² λ³΄μ΄μ§€λ§ μ‚¬μ‹¤μ΄ μ•„λ‹**
- DIP μ£Όλ¬Έ μ„λΉ„μ¤ ν΄λΌμ΄μ–ΈνΈ( `OrderServiceImpl`) λ” `DiscountPolicy` μΈν„°νμ΄μ¤μ— μμ΅΄ν•λ©΄μ„ DIP λ¥Ό μ§€ν‚¨κ±΄ κ°™μ€λ°?
    - ν΄λμ¤μ μμ΅΄ κ΄€κ³„λ¥Ό λ¶„μ„ν•΄λ³΄μ β†’ μ¶”μƒ(μΈν„°νμ΄μ¤) λΏλ§ μ•„λ‹λΌ **κµ¬μ²΄(κµ¬ν„) ν΄λμ¤μ—λ„ μμ΅΄** ν•κ³  μλ‹¤
        - μ¶”μƒ(interface)μμ΅΄: DiscountPolicy
        - κµ¬μ²΄(κµ¬ν„) ν΄λμ¤: FixDiscountPolicy RateDiscountPolicy
- OCP: λ³€κ²½ν•μ§€ μ•κ³  ν™•μ¥ ν• μμλ‹¤κ³  ν–λ”λ°?
    - **μ§€κΈ μ½”λ“λ” κΈ°λ¥μ„ ν™•μ¥ν•΄μ„ λ³€κ²½ν•λ©΄ ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μν–¥μ„ μ¤€λ‹¤**
    - **λ”°λΌμ„ OCP λ¥Ό μ„λ°ν•λ‹¤**

## μ™ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•΄μ•Ό ν• κΉ?

- ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨μΌλ΅ μμ΅΄κ΄€κ³„λ¥Ό λ¶„μ„ν•΄λ³΄μ

## κΈ°λ€ν–λ μμ΅΄κ΄€κ³„

- OrderServiceImpl β†’ DiscountPolicy (FixDiscountPolicy RateDiscountPolicy)

## μ‹¤μ  μμ΅΄κ΄€κ³„

- OrderServiceImpl β†’ DiscountPolicy
    - (FixDiscountPolicy RateDiscountPolicy)
- μΈν„°νμ΄μ¤λ§ μμ΅΄ν•λ”μ¤„ μ•μ•μ§€λ§ μ‹¤μ  κµ¬ν„μ²΄λ„ μμ΅΄ν•κ³  μμ
    - μ‹¤μ  μ½”λ“λ¥Ό λ³΄λ©΄ μμ΅΄ν•κ³  μμ
- DIP μ„λ°!

## μ •μ±… λ³€κ²½

- FixDiscountPolicy  μ—μ„ RateDiscountPolicy λ΅ λ³€κ²½ν•λ” μκ°„ OrderServiceImple μ μ†μ¤ μ½”λ“λ„ λ³€κ²½ν•΄μ•Ό ν•λ‹¤
- OCP μ„λ°

## μ–΄λ–»κ² λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μμ„κΉ?

- ν΄λΌμ΄μ–ΈνΈ μ½”λ“μΈ OrderServiceImpl μ€ DiscountPolicy μ μΈν„°νμ΄μ¤ λΏλ§ μ•„λ‹λΌ κµ¬μ²΄ ν΄λμ¤λ„ ν•¨κ» μμ΅΄ν•΄μ•Ό ν•λ‹¤
- κ·Έλμ„ κµ¬μ²΄ ν΄λμ¤λ¥Ό λ³€κ²½ν•  λ• ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν•λ‹¤
- DIP μ„λ° β†’ μ¶”μƒμ—λ§ μμ΅΄ν•λ„λ΅ λ³€κ²½
    - μΈν„°νμ΄μ¤μ—λ§ μμ΅΄
- DIP λ¥Ό μ„λ°ν•μ§€ μ•λ„λ΅ **μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μμ΅΄ κ΄€κ³„λ¥Ό λ³€κ²½ν•λ©΄ λλ‹¤**

## μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„ λ³€κ²½

- OrderServiceImpl β†’ DiscountPolicy ~~(FixDiscountPolicy RateDiscountPolicy)~~

```java
    private final MemberRepository memberRepository = new MemoryMemberRepository();
    // private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
    // private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
    private DiscountPolicy discountPolicy;
```

- μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„μ™€ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤
- κ·Έλ°λ° κµ¬ν„μ²΄κ°€ μ—†λ”λ° μ½”λ“λ¥Ό μ–΄λ–»κ² μ‹¤ν–‰ ν•  μ μμ„κΉ?
- μ‹¤μ  μ‹¤ν–‰μ„ ν•΄λ³΄λ©΄ Null Pointer Exception λ°μƒ

## ν•΄κ²°λ°©μ•

- μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•λ ¤λ©΄ λ„κµ°κ°€κ°€ ν΄λΌμ΄μ–ΈνΈμΈ OrderServiceImpl μ— DiscountPolicy μ κµ¬ν„ κ°μ²΄λ¥Ό λ€μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•΄μ•Ό ν•λ‹¤

# κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

- μ–΄ν”λ¦¬μΌ€μ΄μ…μ„ ν•λ‚μ κ³µμ—°μ΄λΌκ³  μƒκ°ν•΄λ³΄μ. κ°κ°μ μΈν„°νμ΄μ¤λ¥Ό λ°°μ—­μ΄λΌ μƒκ°ν•μ. κ·Έλ°λ° μ‹¤μ  λ°°μ—­μ— λ§λ” λ°°μ°λ¥Ό μ„ νƒν•λ”κ²ƒμ€ λ„κ°€ ν•λ”κ°€?
- λ΅λ―Έμ¤μ™€ μ¤„λ¦¬μ—£ λ°°μ—­μ„ λ„κ°€ μ •ν• μ§€λ” λ°°μ°λ“¤μ΄ ν•λ”κ² μ•„λ‹λ‹¤
- μ΄μ „ μ½”λ“λ” λ΅λ―Έμ¤ μ—­ν™(μΈν„°νμ΄μ¤)μ„ ν•λ” λ μ¤λ‚λ¥΄λ„ λ””μΉ΄ν”„λ¦¬μ¤(κµ¬ν„μ²΄)λ°°μ°κ°€ μ—¬μ£ΌμΈκ³µμ„ μ§μ ‘ μ΄λΉ™ν•λ”κ²ƒκ³Ό κ°™λ‹¤
- λ””μΉ΄ν”„λ¦¬μ¤λ” κ³µμ—°λ„ ν•κ³  μ—¬μ£ΌμΈκ³µλ„ κ³µμ—°μ— μ§μ ‘ μ΄λΉ™ν•λ” **λ‹¤μ–‘ν• μ±…μ„**μ„ κ°€μ§€κ³  μλ‹¤

## κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ

- λ°°μ°λ” λ³ΈμΈμ μ—­ν™μ„ μν–‰ν•λ” κ²ƒμ—λ§ μ§‘μ¤‘ν•΄μ•Όν•λ‹¤
- λ””μΉ΄ν”„λ¦¬μ¤λ” μ–΄λ–¤ μ—¬μ£ΌμΈκ³µμ΄ μ„ νƒλλ”λΌλ„ λ‘κ°™μ€ κ³µμ—°μ„ ν• μμμ–΄μ•Ό ν•λ‹¤
- κ³µμ—°μ„ κµ¬μ„± + λ°°μ°λ¥Ό μ„­μ™Έ + μ—­ν™μ— λ§λ” λ°°μ°λ¥Ό μ§€μ •, ν•΄λ‹Ή μΌλ“¤μ μ±…μ„μ„ λ‹΄λ‹Ήν•λ” **κ³µμ—°κΈ°νμ**κ°€ λ‚μ™€μ•Όλ  μ‹μ 
- κ³µμ—° κΈ°νμλ¥Ό λ§λ“¤κ³ , λ°°μ°μ™€ κ³µμ—° κΈ°νμμ κ΄€μ‹¬μ„ ν™•μ‹¤ν λ¶„λ¦¬ν•μ

## AppConfig λ“±μ¥

- μ–΄ν”λ¦¬μΌ€μ΄μ…μ μ „μ²΄ λ™μ‘μ„ κµ¬μ„±(config) ν•κΈ° μ„ν•΄ **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•κ³  **μ—°κ²°**ν•λ” μ±…μ„μ„ κ°€μ§€λ” λ³„λ„μ μ„¤μ • ν΄λμ¤λ¥Ό λ§λ“¤μ

## κ³Όμ • μ •λ¦¬

- μ λ³΄λ©΄ κµ¬ν„ κ°μ²΄ ν΄λμ¤(Impl) λ΅ κµ¬ν„ν•΄λ†“μ€ ν΄λμ¤λ¥Ό λ³΄λ©΄ μ•μ— MemberRepository λ¥Ό μ–΄λ–¤ κµ¬ν„μ²΄λ΅ κµ¬ν„ν• μ§€λ¥Ό μ§μ ‘ μ„ μ–Έν–μ—μ
- μ΄κ²ƒμ€ λ°°μ°κ°€ μ§μ ‘ λ‹Ήλ‹Ήλ°°μ°λ¥Ό μ„­μ™Έλ¥Ό ν•λ”κ±°λ‘ κ°™μ€κ²ƒ
- κ·Έλ°κ±°λ¥Ό AppConfig μ—μ„ λ‹¤ ν•΄μ£Όλ©΄λ¨
- μƒμ„±μλ¥Ό ν†µν•΄μ„ λ„£μ–΄μ¤„κ²ƒ(μ£Όμ…)
- μ΄μ  μ² μ €ν•κ² μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ” λ¨μµμ„ λ³Ό μ μμ
    - μƒμ„±μλ΅ μΈν„°νμ΄μ¤ νƒ€μ…λ§ λ°›λ‹¤λ³΄λ‹ κµ¬ν„μ²΄κ°€ λ­κ°€ λ“¤μ–΄μ¬ μ§€ μ• μ μ—†μ

## AppConfig

- AppConfig λ” μ–΄ν”λ¦¬μΌ€μ΄μ…μ μ‹¤μ  λ™μ‘μ— ν•„μ”ν• **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±** ν•λ‹¤
    - `MemberServiceImpl`
    - `MemoryMemberRepository`
    - `OrderServiceImpl`
    - `FixDiscountPolicy`
- AppConfig λ” μƒμ„±ν• κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°(λ λ¬ν€μ¤)λ¥Ό **μƒμ„±μλ¥Ό ν†µν•΄μ„ μ£Όμ…(μ—°κ²°)** ν•΄μ¤€λ‹¤
    - `MemberServiceImpl` β†’ `MemoryMemberRepository`
    - `OrderServiceImpl` β†’ `MemoryMemberRepository`, `FixDiscountPolicy`

> μ°Έκ³ : μ§€κΈμ€ κ° ν΄λμ¤μ— μƒμ„±μκ°€ μ—†μ–΄μ„ μ»΄νμΌ μ¤λ¥κ°€ λ°μƒ. λ°”λ΅ λ‹¤μμ— μ½”λ“μ—μ„ μƒμ„±μλ¥Ό λ§λ“ λ‹¤
> 

## μƒμ„±μ μ£Όμ…

- μ„¤κ³„ λ³€κ²½μΌλ΅ `MemberServiceImpl` μ€ `MemoryMemberRepository` λ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤
- λ‹¨μ§€ `MemberRepository` μ μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ‹¤
- `MemberServiceImpl` μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€(μ£Όμ…λ μ§€) μ• μ μ—†λ‹¤
- `MemberServiceImpl` μ€ **μμ΅΄κ΄€κ³„μ— λ€ν• κ³ λ―Όμ€ μ™Έλ¶€**μ— λ§΅κΈ°κ³  **μ‹¤ν–‰μ—λ§ μ§‘μ¤‘**

## ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨

- κ°μ²΄μ μƒμ„±κ³Ό μ—°κ²°μ€ AppConfig κ°€ λ‹΄λ‹Ή
- **DIP μ™„μ„±**: `MemberServiceImpl` μ€  `MemberRepository` μΈ μ¶”μƒμ—λ§ μμ΅΄ν•λ©΄ λλ‹¤. μ΄μ  κµ¬ν„ ν΄λμ¤λ¥Ό λ°λΌλ„ λλ‹¤
- **κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬**: κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν™κ³Ό μ‹¤ν–‰ν•λ” μ—­ν™μ΄ λ…ν™•ν λ¶„λ¦¬λλ‹¤

## κ°μ²΄ μΈμ¤ν„΄μ¤ λ‹¤μ΄μ–΄κ·Έλ¨

- appConfig κ°μ²΄λ” `MemoryMemberRepository` κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ°Έμ΅°κ°’μ„ `MemberServiceImpl` μ„ μƒμ„±ν•λ©΄ μƒμ„±μλ΅ μ „λ‹¬
- ν΄λΌμ΄μ–ΈνΈμΈ `MemberServiceImpl` μ…μ¥μ—μ„ λ³΄λ©΄ μμ΅΄κ΄€κ³„λ¥Ό λ§μΉ μ™Έλ¶€μ—μ„ μ£Όμ…ν•΄μ£Όλ” κ²ƒκ³Ό κ°™λ‹¤κ³  ν•΄μ„ DI(Dependency Injection) μ°λ¦¬λ§λ΅ μμ΅΄μ„± μ£Όμ…μ΄λΌκ³  λ§ν•¨

## OrderServiceImpl μƒμ„±μ μ£Όμ…

- μ„¤κ³„ λ³€κ²½μΌλ΅ `OrderServiceImpl`  μ€ `FixDiscountPolicy` λ¥Ό μμ΅΄ν•μ§€ μ•μ
- λ‹¨μ§€ `DiscountPolicy` μ—λ§ μμ΅΄
- `OrderServiceImpl` μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€(μ£Όμ…λ μ§€)λ” μ• μ μ—†λ‹¤
- `OrderServiceImpl` μ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ¥Ό μ£Όμ…ν• μ§€λ” μ¤μ§ μ™Έλ¶€(AppConfig ) μ—μ„ κ²°μ •ν•λ‹¤
- `OrderServiceImpl` μ€ μ΄μ λ¶€ν„° μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•λ©΄ λλ‹¤
- `OrderServiceImpl` μ—λ” `MemoryMemberRepository` , `FixDiscountPolicy` κ°μ²΄μ μμ΅΄κ΄€κ³„κ°€ μ£Όμ…λλ‹¤

## AppConfig μ‹¤ν–‰

- μ •μƒ λ™μ‘ν•¨
- ν•μ§€λ§ μ§€κΈ appConfig λ¥Ό λ³΄λ©΄ μμ •ν• κ² μμ–΄λ³΄μ„

# AppConfig λ¦¬ν©ν† λ§

# μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

# μ „μ²΄ νλ¦„ μ •λ¦¬

# μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™ μ μ©

# IoC DI κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„

# μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°